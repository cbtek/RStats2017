/*
    UIRStatsImportWorksheet.cpp
    

*/
//UIRStatsImportWorksheet.cpp generated by cbtek on 03-17-2017 at 02:46:14 PM

#include "UIRStatsImportWorksheet.h"
#include "ui_UIRStatsImportWorksheet.h"

#include "rstats_ui/inc/UIRStatsErrorMessage.h"

using namespace oig::ratstats::utils;

namespace oig {
namespace ratstats {
namespace ui {

UIRStatsImportWorksheet::UIRStatsImportWorksheet(const RStatsWorkbook& workbook,
                                                 QWidget *parent) :
    QDialog(parent),
    m_ui(new Ui_UIRStatsImportWorksheet)
{
    m_ui->setupUi(this);
    if (workbook.getNumWorksheets() == 0)
    {
        UIRStatsErrorMessage("No Worksheets!?", "There do not appear to be any valid worksheets in this workbook",false,this).exec();
    }
    this->setWindowTitle("Please select a worksheet to import...");
    m_workbookWidget = new UIRStatsWorkbook(workbook);
    connect(m_workbookWidget, SIGNAL(sheetSelected(oig::ratstats::utils::RStatsWorksheet)), this,SLOT(onSheetSelected(oig::ratstats::utils::RStatsWorksheet)));
    connect(m_ui->m_btnCancel,SIGNAL(clicked(bool)),this,SLOT(onCancel()));
    connect(m_ui->m_btnOk,SIGNAL(clicked(bool)),this,SLOT(onOk()));
    m_ui->m_lytTable->addWidget(m_workbookWidget);
}

UIRStatsImportWorksheet::~UIRStatsImportWorksheet()
{
    delete m_ui;
}

void UIRStatsImportWorksheet::onOk()
{
    m_currentSheet = m_workbookWidget->getCurrentSheet();
    if (!m_currentSheet.isEmpty())
    {
        emit sheetSelected(m_currentSheet);
    }
   this->close();
}

void UIRStatsImportWorksheet::onCancel()
{
    this->close();
}

void UIRStatsImportWorksheet::onSheetSelected(const RStatsWorksheet &sheet)
{
    m_currentSheet = sheet;
}
}}}//end namespace

